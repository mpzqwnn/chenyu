{"version":3,"file":"js/899.c64642db.js","mappings":"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","sources":["webpack://shop/./src/views/address/AddressEdit.vue","webpack://shop/./src/views/address/AddressEdit.vue?5af7"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"head\">\r\n      <span @click=\"backToAddressList\" class=\"iconfont icon-left\"></span>\r\n      <span class=\"title\">编辑收货地址</span>\r\n      <span @click=\"submitForm\" class=\"button\">保存</span>\r\n    </div>\r\n    <div class=\"info\">\r\n      <div class=\"item\">\r\n        <span class=\"text\">所在城市：</span>\r\n        <input\r\n          v-model=\"address.city\"\r\n          type=\"text\"\r\n          class=\"input-item\"\r\n          placeholder=\"如北京市\"\r\n        />\r\n      </div>\r\n      <div class=\"gap\"></div>\r\n      <div class=\"item\">\r\n        <span class=\"text\">小区/大厦/学校：</span>\r\n        <input\r\n          v-model=\"address.community\"\r\n          type=\"text\"\r\n          class=\"input-item\"\r\n          placeholder=\"如理工大学国防科技园\"\r\n        />\r\n      </div>\r\n      <div class=\"gap\"></div>\r\n      <div class=\"item\">\r\n        <span class=\"text\">楼号-门牌号：</span>\r\n        <input\r\n          v-model=\"address.building\"\r\n          type=\"text\"\r\n          class=\"input-item\"\r\n          placeholder=\"A号楼B层\"\r\n        />\r\n      </div>\r\n      <div class=\"gap\"></div>\r\n      <div class=\"item\">\r\n        <span class=\"text\">收货人：</span>\r\n        <input\r\n          v-model=\"address.username\"\r\n          type=\"text\"\r\n          class=\"input-item\"\r\n          placeholder=\"请填写收货人的姓名\"\r\n        />\r\n      </div>\r\n      <div class=\"gap\"></div>\r\n      <div class=\"item\">\r\n        <span class=\"text\">联系电话：</span>\r\n        <input\r\n          v-model=\"address.phone\"\r\n          type=\"text\"\r\n          class=\"input-item\"\r\n          placeholder=\"请填写收货手机号\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <Toast v-if=\"isShow\" :message=\"toastMessage\" />\r\n</template>\r\n<script>\r\nimport router from \"@/router\";\r\nimport { reactive,onMounted } from \"vue\";\r\nimport { get,put } from \"../../utils/request\";\r\nimport Toast, { showToastEffect } from \"../../components/Toast.vue\";\r\nimport Schema from \"async-validator\";\r\nexport default {\r\n  components: { Toast },\r\n  name: \"AddressCreate\",\r\n  setup() {\r\n    const rule = {\r\n      city: [\r\n        {\r\n          required: true,\r\n          message: \"城市不能为空\",\r\n        },\r\n      ],\r\n      community: [\r\n        {\r\n          required: true,\r\n          message: \"小区不能为空\",\r\n        },\r\n      ],\r\n      building: [\r\n        {\r\n          required: true,\r\n          message: \"楼号不能为空\",\r\n        },\r\n      ],\r\n      username: [\r\n        {\r\n          required: true,\r\n          message: \"收货人不能为空\",\r\n        },\r\n        {\r\n          pattern: /^[\\u4e00-\\u9fa5]{2,4}$/,\r\n          message: \"请输入有效的中文名字\",\r\n        },\r\n      ],\r\n      phone: [\r\n        {\r\n          required: true,\r\n          message: \"联系电话不能为空\",\r\n        },\r\n        {\r\n          pattern: /^1[0-9]{10}$/,\r\n          message: \"请输入有效的手机号码\",\r\n        },\r\n      ],\r\n    };\r\n    const { showToast, isShow, toastMessage } = showToastEffect();\r\n    // 跳转到地址列表页面\r\n    const backToAddressList = () => {\r\n      router.push(\"/address-list\");\r\n    };\r\n    const addressId = router.currentRoute.value.params.id;\r\n    const address = reactive({\r\n      city: \"\",\r\n      community: \"\",\r\n      building: \"\",\r\n      username: \"\",\r\n      phone: \"\",\r\n    });\r\n    // 校验表单\r\n    const validateForm = async () => {\r\n      // 创建校验器\r\n      const validator = new Schema(rule);\r\n      try {\r\n        // 校验, 参数是要校验的对象, 就是收集到的表单数据\r\n        await validator.validate(address);\r\n        // 校验成功\r\n        console.log(\"校验成功\");\r\n        // 调用接口, 保存地址\r\n        console.log(address);\r\n        // address 转成普通对象\r\n        const data = JSON.parse(JSON.stringify(address));\r\n        // 发送请求, 获取响应数据\r\n        const res = await put(`/address${addressId}`, data);\r\n        // 判断错误码\r\n        if (res.errno === 0) {\r\n          // 创建地址成功\r\n          showToast(\"编辑地址成功\");\r\n          // 1秒之后跳转到地址列表页\r\n          setTimeout(() => {\r\n            // 跳转到地址列表页\r\n            router.push(\"/address-list\");\r\n          }, 1000);\r\n        } else {\r\n          // 登录失败, 提示用户, res.message是错误信息\r\n          showToast(res.message);\r\n        }\r\n      } catch (errors) {\r\n        // 校验失败\r\n        showToast(errors.errors[0].message);\r\n      }\r\n    };\r\n    // 提交表单\r\n    const submitForm = () => {\r\n      // 校验表单\r\n      validateForm();\r\n    };\r\n    onMounted(() => {\r\n      // 获取地址信息\r\n      getAddressInfo();\r\n    });\r\n    // 通过接口获取地址信息\r\n    const getAddressInfo = async () => {\r\n      const res = await get(`/address/${addressId}`);\r\n      Object.assign(address, res.data);\r\n      console.log(address);\r\n    };\r\n    return {\r\n      backToAddressList,\r\n      address,\r\n      isShow,\r\n      toastMessage,\r\n      submitForm,\r\n    };\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import \"../../style/address-common.scss\";\r\n</style>\r\n","import { render } from \"./AddressEdit.vue?vue&type=template&id=282be0bc&scoped=true\"\nimport script from \"./AddressEdit.vue?vue&type=script&lang=js\"\nexport * from \"./AddressEdit.vue?vue&type=script&lang=js\"\n\nimport \"./AddressEdit.vue?vue&type=style&index=0&id=282be0bc&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-282be0bc\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_hoisted_1","_hoisted_2","onClick","_cache","args","$setup","backToAddressList","_hoisted_3","submitForm","_hoisted_4","_hoisted_5","_hoisted_6","address","city","$event","type","placeholder","_hoisted_7","_hoisted_8","_hoisted_9","community","_hoisted_10","_hoisted_11","_hoisted_12","building","_hoisted_13","_hoisted_14","_hoisted_15","username","_hoisted_16","_hoisted_17","_hoisted_18","phone","isShow","_createBlock","_component_Toast","message","toastMessage","components","Toast","name","setup","rule","required","pattern","showToast","showToastEffect","router","push","addressId","currentRoute","value","params","id","reactive","validateForm","async","validator","Schema","validate","console","log","data","JSON","parse","stringify","res","put","errno","setTimeout","errors","onMounted","getAddressInfo","get","Object","assign","__exports__","render"],"sourceRoot":""}